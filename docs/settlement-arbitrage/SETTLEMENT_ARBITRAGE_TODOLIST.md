# ç»“ç®—ä»·å·®å¥—åˆ©ç­–ç•¥ - å®Œæ•´ç‰ˆå¼€å‘ TodoList

> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
> **åˆ›å»ºæ—¶é—´**: 2026-02-09  
> **å…³è”éœ€æ±‚**: [SETTLEMENT_ARBITRAGE_FULL_REQUIREMENT.md](./SETTLEMENT_ARBITRAGE_FULL_REQUIREMENT.md)  
> **é¢„è®¡æ€»å·¥æ—¶**: çº¦ 90-100 å°æ—¶

---

## ğŸ“‹ ä»»åŠ¡æ€»è§ˆ

| é˜¶æ®µ | ä»»åŠ¡åç§° | ä¼˜å…ˆçº§ | é¢„è®¡å·¥æ—¶ | çŠ¶æ€ | ä¾èµ– |
|------|---------|--------|----------|------|------|
| 1 | æ•°æ®å±‚ - åˆ†é’Ÿæ•°æ®è·å– | P0 | 10å°æ—¶ | â¬œ å¾…å¼€å‘ | - |
| 2 | ç­–ç•¥æ ¸å¿ƒå±‚ | P0 | 20å°æ—¶ | â¬œ å¾…å¼€å‘ | é˜¶æ®µ1 |
| 3 | æ‰§è¡Œä¸é€šçŸ¥å±‚ | P0 | 12å°æ—¶ | â¬œ å¾…å¼€å‘ | é˜¶æ®µ2 |
| 4 | åç«¯APIè·¯ç”± | P0 | 8å°æ—¶ | â¬œ å¾…å¼€å‘ | é˜¶æ®µ2,3 |
| 5 | å‰ç«¯APIå°è£… | P0 | 2å°æ—¶ | â¬œ å¾…å¼€å‘ | é˜¶æ®µ4 |
| 6 | å‰ç«¯é¡µé¢å¼€å‘ | P1 | 20å°æ—¶ | â¬œ å¾…å¼€å‘ | é˜¶æ®µ5 |
| 7 | å›æµ‹å¼•æ“å¢å¼º | P1 | 12å°æ—¶ | â¬œ å¾…å¼€å‘ | é˜¶æ®µ1,2 |
| 8 | é›†æˆæµ‹è¯• | P1 | 8å°æ—¶ | â¬œ å¾…å¼€å‘ | å…¨éƒ¨ |

---

## ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

```
backend_api_python/app/
â”œâ”€â”€ strategies/
â”‚   â””â”€â”€ settlement_arbitrage/          # ğŸ†• æ–°å»ºç›®å½•
â”‚       â”œâ”€â”€ __init__.py                # æ¨¡å—åˆå§‹åŒ–
â”‚       â”œâ”€â”€ strategy.py                # ç­–ç•¥æ ¸å¿ƒé€»è¾‘
â”‚       â”œâ”€â”€ data_handler.py            # åˆ†é’Ÿæ•°æ®å¤„ç†å™¨
â”‚       â”œâ”€â”€ vwap_calculator.py         # ç»“ç®—ä»·VWAPè®¡ç®—
â”‚       â”œâ”€â”€ position_manager.py        # ä»“ä½ç®¡ç†
â”‚       â”œâ”€â”€ risk_manager.py            # é£æ§ç®¡ç†
â”‚       â”œâ”€â”€ scheduler.py               # ç­–ç•¥è°ƒåº¦å™¨
â”‚       â””â”€â”€ config.py                  # ç­–ç•¥é…ç½®
â”‚
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ settlement_strategy.py         # ğŸ†• ç­–ç•¥ä¸“å±APIè·¯ç”±
â”‚
â”œâ”€â”€ models/
â”‚   â””â”€â”€ settlement_strategy.py         # ğŸ†• ç­–ç•¥æ•°æ®æ¨¡å‹
â”‚
â””â”€â”€ services/
    â””â”€â”€ (ä½¿ç”¨ç°æœ‰æœåŠ¡)

quantdinger_vue/src/
â””â”€â”€ views/
    â””â”€â”€ settlement-strategy/           # ğŸ†• æ–°å»ºç›®å½•
        â”œâ”€â”€ index.vue                  # ä¸»é¡µé¢
        â””â”€â”€ components/
            â”œâ”€â”€ MonitorPanel.vue       # å®æ—¶ç›‘æ§é¢æ¿
            â”œâ”€â”€ ConfigPanel.vue        # ç­–ç•¥é…ç½®é¢æ¿
            â”œâ”€â”€ PositionTable.vue      # æŒä»“è¡¨æ ¼
            â”œâ”€â”€ TradeHistory.vue       # äº¤æ˜“å†å²
            â”œâ”€â”€ BacktestPanel.vue      # å›æµ‹é¢æ¿
            â””â”€â”€ PnlChart.vue           # ç›ˆäºå›¾è¡¨
```

---

## é˜¶æ®µ1: æ•°æ®å±‚ - åˆ†é’Ÿæ•°æ®è·å– (P0)

### 1.1 åˆ†é’ŸKçº¿æ•°æ®æ¥å£å¢å¼º
- **æ–‡ä»¶**: `backend_api_python/app/data_sources/cn_futures.py`
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] å®ç° `get_minute_bars(symbol, period, count)` æ–¹æ³•
  - æ”¯æŒ1åˆ†é’Ÿ/5åˆ†é’Ÿ/15åˆ†é’Ÿå‘¨æœŸ
  - è¿”å›DataFrameæ ¼å¼æ•°æ®
- [ ] å®ç°æ•°æ®æºè‡ªåŠ¨åˆ‡æ¢ï¼ˆakshare -> æ–°æµª -> ä¸œæ–¹è´¢å¯Œï¼‰
- [ ] æ·»åŠ åˆ†é’Ÿæ•°æ®ç¼“å­˜æœºåˆ¶
- [ ] å®ç°æ•°æ®å®Œæ•´æ€§æ ¡éªŒ

**æ¥å£å®šä¹‰:**
```python
def get_minute_bars(
    self,
    symbol: str,           # åˆçº¦ä»£ç : "IM0" æˆ– "IM2503"
    period: int = 1,       # Kçº¿å‘¨æœŸ(åˆ†é’Ÿ): 1/5/15/30/60
    count: int = 240,      # è·å–æ•°é‡ï¼ˆé»˜è®¤1å¤©240æ ¹1åˆ†é’ŸKçº¿ï¼‰
    start_date: str = None # èµ·å§‹æ—¥æœŸ(å¯é€‰)
) -> pd.DataFrame:
    """
    è¿”å›å­—æ®µ: datetime, open, high, low, close, volume, amount
    """
```

---

### 1.2 å®æ—¶æ•°æ®è®¢é˜…æœºåˆ¶
- **æ–‡ä»¶**: `backend_api_python/app/strategies/settlement_arbitrage/data_handler.py`
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] åˆ›å»º `MinuteDataHandler` ç±»
- [ ] å®ç° `subscribe(symbols)` æ–¹æ³• - è®¢é˜…å¤šå“ç§
- [ ] å®ç° `on_bar(callback)` æ–¹æ³• - Kçº¿å›è°ƒ
- [ ] å®ç° `get_realtime_quote(symbol)` æ–¹æ³• - è·å–å®æ—¶è¡Œæƒ…
- [ ] å®ç°æ–­çº¿é‡è¿æœºåˆ¶
- [ ] å®ç°æ•°æ®å»é‡å¤„ç†

**ç±»ç»“æ„:**
```python
class MinuteDataHandler:
    def __init__(self, data_source: CNFuturesDataSource):
        self.data_source = data_source
        self.subscribers = []
        self.cache = {}
        
    def subscribe(self, symbols: List[str]):
        """è®¢é˜…å¤šä¸ªåˆçº¦çš„åˆ†é’Ÿæ•°æ®"""
        
    def on_bar(self, callback: Callable):
        """æ³¨å†ŒKçº¿å›è°ƒå‡½æ•°"""
        
    def start_polling(self, interval: int = 60):
        """å¼€å§‹è½®è¯¢ï¼ˆæ¯åˆ†é’Ÿæ›´æ–°ï¼‰"""
        
    def stop(self):
        """åœæ­¢è®¢é˜…"""
```

---

### 1.3 æ•°æ®ç¼“å­˜ä¸å­˜å‚¨
- **æ–‡ä»¶**: `backend_api_python/app/strategies/settlement_arbitrage/data_handler.py`
- **é¢„è®¡å·¥æ—¶**: 2å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] å®ç°å†…å­˜ç¼“å­˜ï¼ˆå½“æ—¥åˆ†é’Ÿæ•°æ®ï¼‰
- [ ] å®ç°æœ¬åœ°æ–‡ä»¶å­˜å‚¨ï¼ˆå†å²æ•°æ® parquetæ ¼å¼ï¼‰
- [ ] å®ç°æ•°æ®è‡ªåŠ¨è¿‡æœŸæ¸…ç†
- [ ] å®ç°ç¼“å­˜é¢„çƒ­ï¼ˆå¯åŠ¨æ—¶åŠ è½½å½“æ—¥æ•°æ®ï¼‰

**å­˜å‚¨è·¯å¾„:**
```
data/futures/minute/
â”œâ”€â”€ IM/
â”‚   â”œâ”€â”€ 2026-02-08.parquet
â”‚   â””â”€â”€ 2026-02-09.parquet
â”œâ”€â”€ IC/
â”‚   â””â”€â”€ ...
â””â”€â”€ cache/
    â””â”€â”€ realtime.pkl      # å®æ—¶æ•°æ®ç¼“å­˜
```

---

## é˜¶æ®µ2: ç­–ç•¥æ ¸å¿ƒå±‚ (P0)

### 2.1 ç»“ç®—ä»·VWAPè®¡ç®—æ¨¡å—
- **æ–‡ä»¶**: `backend_api_python/app/strategies/settlement_arbitrage/vwap_calculator.py`
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] åˆ›å»º `VWAPCalculator` ç±»
- [ ] å®ç° `calculate_vwap(bars, start_time, end_time)` æ–¹æ³•
- [ ] å®ç° `get_settlement_price(symbol, date)` æ–¹æ³•
- [ ] å®ç°å¢é‡æ›´æ–°VWAPï¼ˆå®æ—¶è®¡ç®—ï¼‰
- [ ] æ·»åŠ VWAPè®¡ç®—å•å…ƒæµ‹è¯•

**ç±»ç»“æ„:**
```python
class VWAPCalculator:
    """ç»“ç®—ä»·(VWAP)è®¡ç®—å™¨"""
    
    def calculate_vwap(
        self, 
        bars: pd.DataFrame,
        start_time: time = time(14, 0),
        end_time: time = time(15, 0)
    ) -> float:
        """
        è®¡ç®—æŒ‡å®šæ—¶æ®µçš„æˆäº¤é‡åŠ æƒå¹³å‡ä»·
        VWAP = Î£(Price * Volume) / Î£(Volume)
        """
        
    def get_settlement_price(self, symbol: str, date: date) -> float:
        """è·å–å†å²ç»“ç®—ä»·ï¼ˆå¦‚æœ‰å®˜æ–¹æ•°æ®åˆ™ä½¿ç”¨å®˜æ–¹æ•°æ®ï¼‰"""
        
    def calculate_realtime_vwap(self, symbol: str) -> float:
        """è®¡ç®—å®æ—¶ç»“ç®—ä»·ï¼ˆå½“æ—¥14:00èµ·çš„VWAPï¼‰"""
```

---

### 2.2 ç­–ç•¥æ ¸å¿ƒé€»è¾‘
- **æ–‡ä»¶**: `backend_api_python/app/strategies/settlement_arbitrage/strategy.py`
- **é¢„è®¡å·¥æ—¶**: 8å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] åˆ›å»º `SettlementArbitrageStrategy` ç±»
- [ ] å®ç°ç­–ç•¥çŠ¶æ€æœºï¼ˆIDLE/WATCHING/POSITION_1/POSITION_2/CLOSINGï¼‰
- [ ] å®ç° `on_bar(bar)` æ–¹æ³• - æ¯æ ¹Kçº¿å¤„ç†
- [ ] å®ç° `check_entry_condition()` æ–¹æ³• - å…¥åœºæ¡ä»¶æ£€æŸ¥
- [ ] å®ç° `check_exit_condition()` æ–¹æ³• - å‡ºåœºæ¡ä»¶æ£€æŸ¥
- [ ] å®ç° `on_day_open()` æ–¹æ³• - æ¬¡æ—¥å¼€ç›˜å¤„ç†
- [ ] å®ç° `_get_base_price_at_1430()` æ–¹æ³• - è·å–åŸºå‡†ä»·
- [ ] æ·»åŠ ç­–ç•¥æ—¥å¿—è®°å½•

**ç­–ç•¥çŠ¶æ€æšä¸¾:**
```python
class StrategyState(Enum):
    IDLE = "idle"              # ç©ºä»“å¾…æœº
    WATCHING = "watching"      # è§‚å¯ŸæœŸï¼ˆ14:30-15:00ï¼‰
    POSITION_1 = "position_1"  # æŒä»“1æ¡£ï¼ˆè·Œå¹…>1%ï¼‰
    POSITION_2 = "position_2"  # æŒä»“2æ¡£ï¼ˆè·Œå¹…>2%ï¼‰
    CLOSING = "closing"        # å¹³ä»“ä¸­
```

**å…¥åœºé€»è¾‘:**
```python
def check_entry_condition(self, bar: MinuteBar) -> Optional[Signal]:
    """
    æ£€æŸ¥å…¥åœºæ¡ä»¶:
    1. å½“å‰æ—¶é—´åœ¨14:30-15:00ä¹‹é—´
    2. ä»·æ ¼ç›¸æ¯”14:30åŸºå‡†ä»·ä¸‹è·Œè¶…è¿‡é˜ˆå€¼
    """
    current_time = bar.datetime.time()
    
    # æ£€æŸ¥æ˜¯å¦åœ¨è§‚å¯Ÿæ—¶æ®µ
    if not (time(14, 30) <= current_time <= time(15, 0)):
        return None
        
    # è®¡ç®—è·Œå¹…
    drop_pct = (bar.close - self.base_price) / self.base_price
    
    # ç¬¬ä¸€æ¡£å…¥åœº
    if self.state == StrategyState.IDLE and drop_pct <= -self.config.threshold_1:
        return Signal(type='BUY', level=1, price=bar.close, drop_pct=drop_pct)
        
    # ç¬¬äºŒæ¡£è¿½åŠ 
    if self.state == StrategyState.POSITION_1 and drop_pct <= -self.config.threshold_2:
        return Signal(type='BUY', level=2, price=bar.close, drop_pct=drop_pct)
        
    return None
```

---

### 2.3 ä»“ä½ç®¡ç†æ¨¡å—
- **æ–‡ä»¶**: `backend_api_python/app/strategies/settlement_arbitrage/position_manager.py`
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] åˆ›å»º `PositionManager` ç±»
- [ ] å®ç° `open_position(symbol, price, quantity, level)` æ–¹æ³•
- [ ] å®ç° `close_position(position_id, price)` æ–¹æ³•
- [ ] å®ç° `close_all_positions(price)` æ–¹æ³•
- [ ] å®ç° `get_current_positions()` æ–¹æ³•
- [ ] å®ç° `calculate_pnl(position, current_price)` æ–¹æ³•
- [ ] å®ç°ä»“ä½æŒä¹…åŒ–ï¼ˆæ•°æ®åº“å­˜å‚¨ï¼‰

**ç±»ç»“æ„:**
```python
class PositionManager:
    def __init__(self, db_session, config: StrategyConfig):
        self.db = db_session
        self.config = config
        
    def open_position(
        self,
        symbol: str,
        price: float,
        quantity: int,
        level: int  # 1=é¦–ä»“, 2=è¿½åŠ 
    ) -> Position:
        """å¼€ä»“å¹¶è®°å½•åˆ°æ•°æ®åº“"""
        
    def close_all_positions(self, exit_price: float) -> List[Trade]:
        """å¹³æ‰æ‰€æœ‰æŒä»“ï¼Œè¿”å›äº¤æ˜“è®°å½•"""
        
    def get_total_margin_used(self) -> float:
        """è·å–æ€»ä¿è¯é‡‘å ç”¨"""
```

---

### 2.4 é£æ§ç®¡ç†æ¨¡å—
- **æ–‡ä»¶**: `backend_api_python/app/strategies/settlement_arbitrage/risk_manager.py`
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] åˆ›å»º `RiskManager` ç±»
- [ ] å®ç° `check_position_limit(symbol)` æ–¹æ³• - ä»“ä½é™åˆ¶æ£€æŸ¥
- [ ] å®ç° `check_daily_loss_limit()` æ–¹æ³• - æ—¥äºæŸé™åˆ¶
- [ ] å®ç° `check_drawdown_limit()` æ–¹æ³• - å›æ’¤é™åˆ¶
- [ ] å®ç° `force_close_all()` æ–¹æ³• - å¼ºåˆ¶å¹³ä»“
- [ ] æ·»åŠ é£æ§äº‹ä»¶æ—¥å¿—

**é£æ§è§„åˆ™:**
```python
class RiskManager:
    def __init__(self, config: RiskConfig):
        self.config = config
        self.daily_pnl = 0
        self.max_equity = 0
        
    def check_all_risks(self) -> Optional[RiskEvent]:
        """
        æ£€æŸ¥æ‰€æœ‰é£æ§è§„åˆ™:
        1. å•å“ç§æŒä»“ä¸Šé™
        2. å•æ—¥æœ€å¤§äºæŸ
        3. æœ€å¤§å›æ’¤
        """
        
    def on_trade(self, trade: Trade):
        """äº¤æ˜“åæ›´æ–°é£æ§çŠ¶æ€"""
        self.daily_pnl += trade.pnl
```

---

## é˜¶æ®µ3: æ‰§è¡Œä¸é€šçŸ¥å±‚ (P0)

### 3.1 ä¿¡å·é˜Ÿåˆ—ä¸å¤„ç†
- **æ–‡ä»¶**: `backend_api_python/app/strategies/settlement_arbitrage/scheduler.py`
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] åˆ›å»º `StrategyScheduler` ç±»
- [ ] å®ç°ä¿¡å·é˜Ÿåˆ—ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰
- [ ] å®ç° `start()` æ–¹æ³• - å¯åŠ¨ç­–ç•¥è°ƒåº¦
- [ ] å®ç° `stop()` æ–¹æ³• - åœæ­¢ç­–ç•¥
- [ ] å®ç° `run_loop()` æ–¹æ³• - ä¸»å¾ªç¯
- [ ] å®ç°å®šæ—¶ä»»åŠ¡ï¼ˆæ¯åˆ†é’Ÿè§¦å‘ï¼‰
- [ ] å®ç°äº¤æ˜“æ—¥åˆ¤æ–­ï¼ˆè·³è¿‡éäº¤æ˜“æ—¥ï¼‰
- [ ] å®ç°ç›˜å‰å‡†å¤‡ï¼ˆå¼€ç›˜å‰åˆå§‹åŒ–ï¼‰
- [ ] å®ç°ç›˜åæ¸…ç†ï¼ˆæ”¶ç›˜åçŠ¶æ€é‡ç½®ï¼‰

**è°ƒåº¦å™¨ç»“æ„:**
```python
class StrategyScheduler:
    def __init__(
        self,
        strategy: SettlementArbitrageStrategy,
        data_handler: MinuteDataHandler,
        notifier: FuturesNotifier
    ):
        self.strategy = strategy
        self.data_handler = data_handler
        self.notifier = notifier
        self.running = False
        
    def start(self):
        """å¯åŠ¨ç­–ç•¥è°ƒåº¦"""
        self.running = True
        self._schedule_tasks()
        
    def _schedule_tasks(self):
        """
        å®šæ—¶ä»»åŠ¡:
        - 09:15 ç›˜å‰å‡†å¤‡
        - 09:30-11:30, 13:00-15:00 åˆ†é’Ÿæ•°æ®è½®è¯¢
        - 14:30-15:00 ç­–ç•¥è§‚å¯ŸæœŸ
        - 15:05 ç›˜åæ¸…ç†
        """
```

---

### 3.2 é€šçŸ¥æ¨¡å—å¢å¼º
- **æ–‡ä»¶**: `backend_api_python/app/services/futures_notification.py` (å·²å­˜åœ¨ï¼Œéœ€å¢å¼º)
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] æ·»åŠ  `send_entry_signal(signal)` æ–¹æ³• - ä¹°å…¥ä¿¡å·é€šçŸ¥
- [ ] æ·»åŠ  `send_exit_signal(trades, total_pnl)` æ–¹æ³• - å–å‡ºä¿¡å·é€šçŸ¥
- [ ] æ·»åŠ  `send_price_alert(symbol, current_drop, threshold)` æ–¹æ³• - ä»·æ ¼é¢„è­¦
- [ ] æ·»åŠ  `send_daily_report(summary)` æ–¹æ³• - æ—¥æŠ¥
- [ ] å®ç°é€šçŸ¥æ¨¡æ¿ï¼ˆMarkdownæ ¼å¼ï¼‰
- [ ] æ·»åŠ é€šçŸ¥èŠ‚æµï¼ˆé¿å…é‡å¤å‘é€ï¼‰

**é€šçŸ¥æ¨¡æ¿ç¤ºä¾‹:**
```python
ENTRY_SIGNAL_TEMPLATE = """
ğŸš€ ã€ä¹°å…¥ä¿¡å·ã€‘ç»“ç®—ä»·å¥—åˆ©

ğŸ“Š åˆçº¦: {symbol} ({name})
ğŸ“‰ å½“å‰ä»·: {current_price:,.1f}
ğŸ“Œ 14:30ä»·: {base_price:,.1f}
ğŸ“‰ è·Œå¹…: {drop_pct:.2%}
ğŸ“Š ç»“ç®—ä»·(VWAP): {vwap:,.1f}
â° æ—¶é—´: {timestamp}

ğŸ’¡ å»ºè®®: ä¹°å…¥{quantity}æ‰‹
ğŸ’° é¢„è®¡ä¿è¯é‡‘: {margin:,.0f}å…ƒ
ğŸ”” æ¡£ä½: ç¬¬{level}æ¡£
"""
```

---

### 3.3 ç­–ç•¥çŠ¶æ€æŒä¹…åŒ–
- **æ–‡ä»¶**: `backend_api_python/app/strategies/settlement_arbitrage/scheduler.py`
- **é¢„è®¡å·¥æ—¶**: 2å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] å®ç°ç­–ç•¥çŠ¶æ€ä¿å­˜åˆ°æ•°æ®åº“
- [ ] å®ç°ç­–ç•¥é‡å¯åçŠ¶æ€æ¢å¤
- [ ] å®ç°ç­–ç•¥å¿ƒè·³è®°å½•
- [ ] å®ç°å¼‚å¸¸çŠ¶æ€æ£€æµ‹ä¸æ¢å¤

---

### 3.4 ç­–ç•¥é…ç½®ç®¡ç†
- **æ–‡ä»¶**: `backend_api_python/app/strategies/settlement_arbitrage/config.py`
- **é¢„è®¡å·¥æ—¶**: 2å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] åˆ›å»º `StrategyConfig` æ•°æ®ç±»
- [ ] åˆ›å»º `RiskConfig` æ•°æ®ç±»
- [ ] å®ç°é…ç½®ä»æ•°æ®åº“åŠ è½½
- [ ] å®ç°é…ç½®çƒ­æ›´æ–°ï¼ˆä¸é‡å¯ç”Ÿæ•ˆï¼‰
- [ ] å®ç°é…ç½®éªŒè¯

**é…ç½®ç»“æ„:**
```python
@dataclass
class StrategyConfig:
    # äº¤æ˜“å“ç§
    symbols: List[str] = field(default_factory=lambda: ["IM0", "IC0"])
    
    # å…¥åœºæ¡ä»¶
    watch_start: time = time(14, 30)
    watch_end: time = time(15, 0)
    threshold_1: float = 0.01  # é¦–ä»“é˜ˆå€¼ 1%
    threshold_2: float = 0.02  # è¿½åŠ é˜ˆå€¼ 2%
    alert_threshold: float = 0.008  # é¢„è­¦é˜ˆå€¼ 0.8%
    
    # ä»“ä½ç®¡ç†
    position_size_1: int = 1  # é¦–ä»“æ‰‹æ•°
    position_size_2: int = 1  # è¿½åŠ æ‰‹æ•°
    max_position_per_symbol: int = 2  # å•å“ç§æœ€å¤§æŒä»“
    
    # é£æ§
    max_daily_loss: float = 10000  # å•æ—¥æœ€å¤§äºæŸ
    max_drawdown: float = 0.05  # æœ€å¤§å›æ’¤
    
    # é€šçŸ¥
    notification_channels: List[str] = field(default_factory=lambda: ["telegram"])
```

---

## é˜¶æ®µ4: åç«¯APIè·¯ç”± (P0)

### 4.1 åˆ›å»ºç­–ç•¥APIè·¯ç”±
- **æ–‡ä»¶**: `backend_api_python/app/routes/settlement_strategy.py`
- **é¢„è®¡å·¥æ—¶**: 6å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**

#### 4.1.1 ç­–ç•¥æ§åˆ¶æ¥å£
- [ ] `GET /api/v1/settlement-strategy/status` - è·å–ç­–ç•¥è¿è¡ŒçŠ¶æ€
- [ ] `POST /api/v1/settlement-strategy/start` - å¯åŠ¨ç­–ç•¥
- [ ] `POST /api/v1/settlement-strategy/stop` - åœæ­¢ç­–ç•¥
- [ ] `GET /api/v1/settlement-strategy/config` - è·å–ç­–ç•¥é…ç½®
- [ ] `PUT /api/v1/settlement-strategy/config` - æ›´æ–°ç­–ç•¥é…ç½®

#### 4.1.2 ç›‘æ§æ•°æ®æ¥å£
- [ ] `GET /api/v1/settlement-strategy/monitor` - è·å–å®æ—¶ç›‘æ§æ•°æ®
  - è¿”å›: å„å“ç§14:30ä»·ã€å½“å‰ä»·ã€è·Œå¹…ã€ç»“ç®—ä»·
- [ ] `GET /api/v1/settlement-strategy/positions` - è·å–å½“å‰æŒä»“
- [ ] `GET /api/v1/settlement-strategy/signals` - è·å–ä»Šæ—¥ä¿¡å·è®°å½•

#### 4.1.3 å†å²æ•°æ®æ¥å£
- [ ] `GET /api/v1/settlement-strategy/trades` - è·å–äº¤æ˜“è®°å½•
  - æ”¯æŒåˆ†é¡µã€æ—¥æœŸç­›é€‰
- [ ] `GET /api/v1/settlement-strategy/pnl` - è·å–ç›ˆäºç»Ÿè®¡
  - æ”¯æŒæ—¥/å‘¨/æœˆ/å¹´ç»´åº¦

#### 4.1.4 å›æµ‹æ¥å£
- [ ] `POST /api/v1/settlement-strategy/backtest` - æ‰§è¡Œç­–ç•¥å›æµ‹
  - å‚æ•°: èµ·æ­¢æ—¥æœŸã€å“ç§ã€å‚æ•°é…ç½®
  - è¿”å›: å®Œæ•´å›æµ‹æŠ¥å‘Š

---

### 4.2 åˆ›å»ºæ•°æ®æ¨¡å‹
- **æ–‡ä»¶**: `backend_api_python/app/models/settlement_strategy.py`
- **é¢„è®¡å·¥æ—¶**: 2å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] åˆ›å»º `SettlementStrategyConfig` æ¨¡å‹
- [ ] åˆ›å»º `SettlementPosition` æ¨¡å‹
- [ ] åˆ›å»º `SettlementTrade` æ¨¡å‹
- [ ] åˆ›å»º `SettlementSignal` æ¨¡å‹
- [ ] åˆ›å»ºæ•°æ®åº“è¿ç§»è„šæœ¬

**æ¨¡å‹å­—æ®µ:**
```python
# SettlementStrategyConfig
class SettlementStrategyConfig(Base):
    __tablename__ = "settlement_strategy_config"
    
    id = Column(Integer, primary_key=True)
    user_id = Column(Integer, ForeignKey("users.id"))
    symbols = Column(JSON)  # ["IM0", "IC0"]
    threshold_1 = Column(Float, default=0.01)
    threshold_2 = Column(Float, default=0.02)
    position_size_1 = Column(Integer, default=1)
    position_size_2 = Column(Integer, default=1)
    max_daily_loss = Column(Float, default=10000)
    notification_channels = Column(JSON)
    is_running = Column(Boolean, default=False)
    created_at = Column(DateTime)
    updated_at = Column(DateTime)

# SettlementTrade
class SettlementTrade(Base):
    __tablename__ = "settlement_trades"
    
    id = Column(Integer, primary_key=True)
    user_id = Column(Integer, ForeignKey("users.id"))
    symbol = Column(String)
    direction = Column(String)  # BUY/SELL
    level = Column(Integer)  # 1=é¦–ä»“, 2=è¿½åŠ 
    quantity = Column(Integer)
    entry_price = Column(Float)
    exit_price = Column(Float)
    base_price = Column(Float)  # 14:30åŸºå‡†ä»·
    drop_pct = Column(Float)  # å…¥åœºè·Œå¹…
    vwap = Column(Float)  # ç»“ç®—ä»·
    pnl = Column(Float)  # ç›ˆäº
    fee = Column(Float)  # æ‰‹ç»­è´¹
    margin = Column(Float)  # ä¿è¯é‡‘
    entry_time = Column(DateTime)
    exit_time = Column(DateTime)
    created_at = Column(DateTime)
```

---

## é˜¶æ®µ5: å‰ç«¯APIå°è£… (P0)

### 5.1 åˆ›å»ºAPIå°è£…æ–‡ä»¶
- **æ–‡ä»¶**: `quantdinger_vue/src/api/settlement-strategy.js`
- **é¢„è®¡å·¥æ—¶**: 2å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] `getStrategyStatus()` - è·å–ç­–ç•¥çŠ¶æ€
- [ ] `startStrategy(config)` - å¯åŠ¨ç­–ç•¥
- [ ] `stopStrategy()` - åœæ­¢ç­–ç•¥
- [ ] `getStrategyConfig()` - è·å–é…ç½®
- [ ] `updateStrategyConfig(config)` - æ›´æ–°é…ç½®
- [ ] `getMonitorData()` - è·å–ç›‘æ§æ•°æ®
- [ ] `getPositions()` - è·å–æŒä»“
- [ ] `getSignals(date)` - è·å–ä¿¡å·è®°å½•
- [ ] `getTrades(params)` - è·å–äº¤æ˜“è®°å½•
- [ ] `getPnlSummary(period)` - è·å–ç›ˆäºç»Ÿè®¡
- [ ] `runBacktest(params)` - æ‰§è¡Œå›æµ‹

**APIå°è£…ç¤ºä¾‹:**
```javascript
import request from '@/utils/request'

const baseUrl = '/api/v1/settlement-strategy'

export function getStrategyStatus() {
  return request({
    url: `${baseUrl}/status`,
    method: 'get'
  })
}

export function startStrategy(config) {
  return request({
    url: `${baseUrl}/start`,
    method: 'post',
    data: config
  })
}

export function getMonitorData() {
  return request({
    url: `${baseUrl}/monitor`,
    method: 'get'
  })
}
```

---

## é˜¶æ®µ6: å‰ç«¯é¡µé¢å¼€å‘ (P1)

### 6.1 é¡µé¢ä¸»æ¡†æ¶
- **æ–‡ä»¶**: `quantdinger_vue/src/views/settlement-strategy/index.vue`
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] åˆ›å»ºé¡µé¢æ•´ä½“å¸ƒå±€
- [ ] å®ç° Tab åˆ‡æ¢ï¼ˆç›‘æ§/é…ç½®/å›æµ‹/å†å²ï¼‰
- [ ] å®ç°æ•°æ®çŠ¶æ€ç®¡ç†
- [ ] å®ç°è‡ªåŠ¨åˆ·æ–°é€»è¾‘ï¼ˆç›‘æ§æ•°æ®æ¯5ç§’åˆ·æ–°ï¼‰
- [ ] å®ç°ç­–ç•¥å¯åœæ§åˆ¶
- [ ] æ·»åŠ è·¯ç”±é…ç½®
- [ ] æ·»åŠ èœå•å…¥å£

---

### 6.2 MonitorPanel.vue - å®æ—¶ç›‘æ§é¢æ¿
- **æ–‡ä»¶**: `quantdinger_vue/src/views/settlement-strategy/components/MonitorPanel.vue`
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**åŠŸèƒ½:**
- [ ] ç­–ç•¥è¿è¡ŒçŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆç»¿è‰²=è¿è¡Œä¸­/ç°è‰²=åœæ­¢ï¼‰
- [ ] å½“å‰æ—¶é—´å’Œè§‚å¯Ÿæ—¶æ®µæç¤º
- [ ] 4ä¸ªå“ç§çš„ç›‘æ§å¡ç‰‡
  - 14:30åŸºå‡†ä»·
  - å½“å‰ä»·ï¼ˆå®æ—¶æ›´æ–°ï¼‰
  - è·Œå¹…ç™¾åˆ†æ¯”ï¼ˆé¢œè‰²æ ‡è¯†ï¼‰
  - ç»“ç®—ä»·(VWAP)
  - è·ç¦»é˜ˆå€¼è·ç¦»
  - è§¦å‘çŠ¶æ€æ ‡è¯†
- [ ] å¯åŠ¨/åœæ­¢ç­–ç•¥æŒ‰é’®
- [ ] ä»Šæ—¥ä¿¡å·ç»Ÿè®¡

**UIå‚è€ƒ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŸ¢ ç­–ç•¥è¿è¡Œä¸­              â° 14:35:28    ğŸ“… 2026-02-09        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    IM0      â”‚ â”‚    IC0      â”‚ â”‚    IF0      â”‚ â”‚    IH0     â”‚ â”‚
â”‚  â”‚ ä¸­è¯1000    â”‚ â”‚ ä¸­è¯500     â”‚ â”‚ æ²ªæ·±300     â”‚ â”‚ ä¸Šè¯50     â”‚ â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚            â”‚ â”‚
â”‚  â”‚ 14:30ä»·:    â”‚ â”‚ 14:30ä»·:    â”‚ â”‚ 14:30ä»·:    â”‚ â”‚ 14:30ä»·:   â”‚ â”‚
â”‚  â”‚ 5,892.0     â”‚ â”‚ 4,521.0     â”‚ â”‚ 3,852.0     â”‚ â”‚ 2,486.0    â”‚ â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚            â”‚ â”‚
â”‚  â”‚ ç°ä»·:       â”‚ â”‚ ç°ä»·:       â”‚ â”‚ ç°ä»·:       â”‚ â”‚ ç°ä»·:      â”‚ â”‚
â”‚  â”‚ 5,826.4ğŸ”´   â”‚ â”‚ 4,498.6     â”‚ â”‚ 3,844.2     â”‚ â”‚ 2,478.4    â”‚ â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚            â”‚ â”‚
â”‚  â”‚ è·Œå¹…: -1.11%â”‚ â”‚ è·Œå¹…: -0.50%â”‚ â”‚ è·Œå¹…: -0.20%â”‚ â”‚ è·Œå¹…:-0.31%â”‚ â”‚
â”‚  â”‚ âœ… å·²è§¦å‘   â”‚ â”‚ è§‚å¯Ÿä¸­      â”‚ â”‚ è§‚å¯Ÿä¸­      â”‚ â”‚ è§‚å¯Ÿä¸­     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 6.3 ConfigPanel.vue - ç­–ç•¥é…ç½®é¢æ¿
- **æ–‡ä»¶**: `quantdinger_vue/src/views/settlement-strategy/components/ConfigPanel.vue`
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**åŠŸèƒ½:**
- [ ] äº¤æ˜“å“ç§å¤šé€‰æ¡†ï¼ˆIC0/IM0/IF0/IH0ï¼‰
- [ ] å…¥åœºæ¡ä»¶é…ç½®
  - é¦–ä»“é˜ˆå€¼ (é»˜è®¤1%)
  - è¿½åŠ é˜ˆå€¼ (é»˜è®¤2%)
  - é¢„è­¦é˜ˆå€¼ (é»˜è®¤0.8%)
- [ ] ä»“ä½é…ç½®
  - é¦–ä»“æ‰‹æ•°
  - è¿½åŠ æ‰‹æ•°
  - å•å“ç§æœ€å¤§æŒä»“
- [ ] é£æ§é…ç½®
  - å•æ—¥æœ€å¤§äºæŸ
  - æœ€å¤§å›æ’¤æ¯”ä¾‹
  - è§¦å‘åå¼ºå¹³å¼€å…³
- [ ] é€šçŸ¥é…ç½®
  - æ¸ é“é€‰æ‹©ï¼ˆTelegram/Emailï¼‰
  - é€šçŸ¥äº‹ä»¶é€‰æ‹©
- [ ] ä¿å­˜/é‡ç½®æŒ‰é’®
- [ ] é…ç½®éªŒè¯æç¤º

---

### 6.4 PositionTable.vue - æŒä»“è¡¨æ ¼
- **æ–‡ä»¶**: `quantdinger_vue/src/views/settlement-strategy/components/PositionTable.vue`
- **é¢„è®¡å·¥æ—¶**: 2å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**åŠŸèƒ½:**
- [ ] è¡¨æ ¼åˆ—: åˆçº¦/æ–¹å‘/æ•°é‡/å¼€ä»“ä»·/ç°ä»·/æµ®ç›ˆ/ä¿è¯é‡‘/å¼€ä»“æ—¶é—´
- [ ] æµ®ç›ˆé¢œè‰²æ ·å¼ï¼ˆçº¢æ¶¨ç»¿è·Œï¼‰
- [ ] ç©ºä»“æç¤º
- [ ] å®æ—¶æµ®ç›ˆæ›´æ–°

---

### 6.5 TradeHistory.vue - äº¤æ˜“å†å²
- **æ–‡ä»¶**: `quantdinger_vue/src/views/settlement-strategy/components/TradeHistory.vue`
- **é¢„è®¡å·¥æ—¶**: 2å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**åŠŸèƒ½:**
- [ ] è¡¨æ ¼åˆ—: æ—¥æœŸ/åˆçº¦/æ–¹å‘/æ¡£ä½/å¼€ä»“ä»·/å¹³ä»“ä»·/ç›ˆäº/æ‰‹ç»­è´¹
- [ ] æ—¥æœŸèŒƒå›´ç­›é€‰å™¨
- [ ] åˆ†é¡µåŠŸèƒ½
- [ ] å¯¼å‡ºExcelåŠŸèƒ½
- [ ] ç›ˆäºé¢œè‰²æ ·å¼

---

### 6.6 BacktestPanel.vue - å›æµ‹é¢æ¿
- **æ–‡ä»¶**: `quantdinger_vue/src/views/settlement-strategy/components/BacktestPanel.vue`
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**åŠŸèƒ½:**
- [ ] å›æµ‹å‚æ•°é…ç½®
  - èµ·æ­¢æ—¥æœŸé€‰æ‹©
  - å“ç§é€‰æ‹©
  - å‚æ•°è°ƒæ•´ï¼ˆé˜ˆå€¼ã€ä»“ä½ï¼‰
- [ ] æ‰§è¡Œå›æµ‹æŒ‰é’®
- [ ] å›æµ‹è¿›åº¦æ˜¾ç¤º
- [ ] å›æµ‹ç»“æœå±•ç¤º
  - åŸºç¡€æŒ‡æ ‡ï¼ˆæ”¶ç›Šç‡/å¤æ™®/å›æ’¤ï¼‰
  - æœˆåº¦æ”¶ç›Šåˆ†å¸ƒå›¾
  - äº¤æ˜“æ˜ç»†è¡¨
- [ ] ç»“æœå¯¼å‡º

---

### 6.7 PnlChart.vue - ç›ˆäºå›¾è¡¨
- **æ–‡ä»¶**: `quantdinger_vue/src/views/settlement-strategy/components/PnlChart.vue`
- **é¢„è®¡å·¥æ—¶**: 2å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**åŠŸèƒ½:**
- [ ] ç›ˆäºç»Ÿè®¡å¡ç‰‡ï¼ˆæ€»ç›ˆäº/èƒœç‡/äº¤æ˜“æ¬¡æ•°ï¼‰
- [ ] ç´¯è®¡ç›ˆäºæ›²çº¿å›¾
- [ ] æ—¥/å‘¨/æœˆç›ˆäºæŸ±çŠ¶å›¾
- [ ] æ—¶é—´èŒƒå›´åˆ‡æ¢
- [ ] å“ç§ç­›é€‰

---

## é˜¶æ®µ7: å›æµ‹å¼•æ“å¢å¼º (P1)

### 7.1 åˆ†é’Ÿçº§å›æµ‹å¼•æ“
- **æ–‡ä»¶**: `backend_api_python/app/services/backtest.py` (å¢å¼º)
- **é¢„è®¡å·¥æ—¶**: 6å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] æ–°å¢ `SettlementStrategyBacktest` ç±»
- [ ] å®ç°åˆ†é’Ÿçº§æ•°æ®å›æµ‹å¾ªç¯
- [ ] å®ç°æ—¥å†…æ—¶é—´ç‚¹åˆ¤æ–­ï¼ˆ14:30å…¥åœºæ£€æµ‹ï¼‰
- [ ] å®ç°è·¨æ—¥æŒä»“å¤„ç†ï¼ˆä»Šä¹°æ˜å–ï¼‰
- [ ] å®ç°VWAPç»“ç®—ä»·å›æµ‹è®¡ç®—
- [ ] å®ç°å›æµ‹ç»“æœç»Ÿè®¡

**å›æµ‹æµç¨‹:**
```python
class SettlementStrategyBacktest:
    def run(self, start_date: date, end_date: date, config: StrategyConfig):
        """
        å›æµ‹ä¸»æµç¨‹:
        1. åŠ è½½å†å²åˆ†é’Ÿæ•°æ®
        2. æŒ‰äº¤æ˜“æ—¥éå†
        3. æ¯æ—¥14:30-15:00æ£€æµ‹å…¥åœºæ¡ä»¶
        4. æ¬¡æ—¥å¼€ç›˜æ¨¡æ‹Ÿå¹³ä»“
        5. ç»Ÿè®¡ç›ˆäºå’Œç»©æ•ˆ
        """
```

---

### 7.2 å›æµ‹æŠ¥å‘Šç”Ÿæˆ
- **æ–‡ä»¶**: `backend_api_python/app/services/backtest.py`
- **é¢„è®¡å·¥æ—¶**: 4å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] å®ç°å®Œæ•´ç»©æ•ˆæŒ‡æ ‡è®¡ç®—
  - æ€»æ”¶ç›Šç‡/å¹´åŒ–æ”¶ç›Š
  - å¤æ™®æ¯”ç‡/ç´¢æè¯ºæ¯”ç‡
  - æœ€å¤§å›æ’¤/å›æ’¤å‘¨æœŸ
  - èƒœç‡/ç›ˆäºæ¯”
  - å¹³å‡æŒä»“æ—¶é—´
- [ ] å®ç°æœˆåº¦æ”¶ç›Šç»Ÿè®¡
- [ ] å®ç°å“ç§åˆ†æç»Ÿè®¡
- [ ] å®ç°äº¤æ˜“æ˜ç»†å¯¼å‡º

**æŠ¥å‘Šç»“æ„:**
```python
@dataclass
class BacktestReport:
    # åŸºç¡€æŒ‡æ ‡
    total_return: float
    annual_return: float
    sharpe_ratio: float
    max_drawdown: float
    win_rate: float
    profit_factor: float
    
    # äº¤æ˜“ç»Ÿè®¡
    total_trades: int
    winning_trades: int
    losing_trades: int
    avg_win: float
    avg_loss: float
    
    # æœˆåº¦æ”¶ç›Š
    monthly_returns: Dict[str, float]
    
    # å“ç§åˆ†æ
    symbol_analysis: Dict[str, SymbolStats]
    
    # äº¤æ˜“æ˜ç»†
    trades: List[TradeRecord]
```

---

### 7.3 å†å²åˆ†é’Ÿæ•°æ®è·å–
- **æ–‡ä»¶**: `backend_api_python/app/data_sources/cn_futures.py`
- **é¢„è®¡å·¥æ—¶**: 2å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**å­ä»»åŠ¡:**
- [ ] å®ç°å†å²åˆ†é’Ÿæ•°æ®æ‰¹é‡è·å–
- [ ] å®ç°æ•°æ®æœ¬åœ°ç¼“å­˜
- [ ] å®ç°æ•°æ®ç¼ºå¤±æ£€æµ‹å’Œå¡«å……

---

## é˜¶æ®µ8: é›†æˆæµ‹è¯• (P1)

### 8.1 å•å…ƒæµ‹è¯•
- **æ–‡ä»¶**: `backend_api_python/tests/test_settlement_strategy.py`
- **é¢„è®¡å·¥æ—¶**: 3å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**æµ‹è¯•ç”¨ä¾‹:**
- [ ] VWAPè®¡ç®—å‡†ç¡®æ€§æµ‹è¯•
- [ ] å…¥åœºæ¡ä»¶åˆ¤æ–­æµ‹è¯•
- [ ] å‡ºåœºé€»è¾‘æµ‹è¯•
- [ ] ä»“ä½ç®¡ç†æµ‹è¯•
- [ ] é£æ§è§„åˆ™æµ‹è¯•

---

### 8.2 é›†æˆæµ‹è¯•
- **é¢„è®¡å·¥æ—¶**: 3å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**æµ‹è¯•é¡¹:**
- [ ] APIæ¥å£è”è°ƒæµ‹è¯•
- [ ] ç­–ç•¥å¯åœåŠŸèƒ½æµ‹è¯•
- [ ] å®æ—¶ç›‘æ§æ•°æ®æµ‹è¯•
- [ ] é€šçŸ¥å‘é€æµ‹è¯•
- [ ] å›æµ‹åŠŸèƒ½æµ‹è¯•

---

### 8.3 ç«¯åˆ°ç«¯æµ‹è¯•
- **é¢„è®¡å·¥æ—¶**: 2å°æ—¶
- **çŠ¶æ€**: â¬œ å¾…å¼€å‘

**æµ‹è¯•åœºæ™¯:**
- [ ] å®Œæ•´äº¤æ˜“æ—¥æ¨¡æ‹Ÿ
- [ ] å¼‚å¸¸æƒ…å†µå¤„ç†ï¼ˆæ•°æ®ä¸­æ–­ã€ç½‘ç»œå¼‚å¸¸ï¼‰
- [ ] éäº¤æ˜“æ—¥è·³è¿‡æµ‹è¯•
- [ ] èŠ‚å‡æ—¥å¤„ç†æµ‹è¯•

---

## ğŸ“ å¼€å‘é¡ºåºå»ºè®®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          å¼€å‘è·¯çº¿å›¾                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Week 1-2: æ ¸å¿ƒåŠŸèƒ½                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1.1æ•°æ®æ¥å£ â†’ 1.2æ•°æ®å¤„ç† â†’ 2.1VWAP â†’ 2.2ç­–ç•¥æ ¸å¿ƒ â†’ 3.1è°ƒåº¦å™¨   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  ğŸ¯ é‡Œç¨‹ç¢‘1: ç­–ç•¥èƒ½åœ¨åå°è¿è¡Œå¹¶è¯†åˆ«ä¿¡å·                                 â”‚
â”‚                                                                          â”‚
â”‚  Week 3: ä»“ä½ä¸é€šçŸ¥                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 2.3ä»“ä½ç®¡ç† â†’ 2.4é£æ§ â†’ 3.2é€šçŸ¥å¢å¼º â†’ 3.3çŠ¶æ€æŒä¹…åŒ–             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  ğŸ¯ é‡Œç¨‹ç¢‘2: ç­–ç•¥å®Œæ•´è¿è¡Œï¼Œä¿¡å·é€šçŸ¥åˆ°æ‰‹æœº                               â”‚
â”‚                                                                          â”‚
â”‚  Week 4: APIä¸å‰ç«¯åŸºç¡€                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 4.1-4.2åç«¯API â†’ 5.1å‰ç«¯API â†’ 6.1ä¸»æ¡†æ¶ â†’ 6.2ç›‘æ§é¢æ¿           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  ğŸ¯ é‡Œç¨‹ç¢‘3: å‰ç«¯èƒ½å±•ç¤ºç­–ç•¥è¿è¡ŒçŠ¶æ€å’Œå®æ—¶ç›‘æ§                           â”‚
â”‚                                                                          â”‚
â”‚  Week 5-6: å‰ç«¯å®Œå–„ä¸å›æµ‹                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 6.3-6.7å‰ç«¯ç»„ä»¶ â†’ 7.1-7.3å›æµ‹å¼•æ“ â†’ 8.1-8.3æµ‹è¯•                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  ğŸ¯ é‡Œç¨‹ç¢‘4: å®Œæ•´çš„å¯è§†åŒ–ç•Œé¢å’Œå›æµ‹ç³»ç»Ÿ                                 â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… å®Œæˆæ ‡è®°è¯´æ˜

| æ ‡è®° | å«ä¹‰ |
|------|------|
| â¬œ | å¾…å¼€å‘ |
| ğŸŸ¡ | å¼€å‘ä¸­ |
| âœ… | å·²å®Œæˆ |
| âŒ | å·²å–æ¶ˆ |
| ğŸ”„ | éœ€è¿”å·¥ |

---

## ğŸ“‹ ä¾èµ–å…³ç³»

| ä»»åŠ¡ | ä¾èµ–äº |
|------|--------|
| 1.2 æ•°æ®å¤„ç† | 1.1 æ•°æ®æ¥å£ |
| 2.1 VWAPè®¡ç®— | 1.1 æ•°æ®æ¥å£ |
| 2.2 ç­–ç•¥æ ¸å¿ƒ | 2.1 VWAPè®¡ç®— |
| 2.3 ä»“ä½ç®¡ç† | 2.2 ç­–ç•¥æ ¸å¿ƒ |
| 2.4 é£æ§ç®¡ç† | 2.2 ç­–ç•¥æ ¸å¿ƒ |
| 3.1 è°ƒåº¦å™¨ | 1.2 æ•°æ®å¤„ç†, 2.2 ç­–ç•¥æ ¸å¿ƒ |
| 3.2 é€šçŸ¥å¢å¼º | 3.1 è°ƒåº¦å™¨ |
| 4.1 åç«¯API | 2.2 ç­–ç•¥æ ¸å¿ƒ, 2.3 ä»“ä½ç®¡ç† |
| 5.1 å‰ç«¯API | 4.1 åç«¯API |
| 6.x å‰ç«¯ç»„ä»¶ | 5.1 å‰ç«¯API |
| 7.x å›æµ‹ | 1.1 æ•°æ®æ¥å£, 2.2 ç­–ç•¥æ ¸å¿ƒ |
| 8.x æµ‹è¯• | å…¨éƒ¨ |

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [å®Œæ•´ç‰ˆéœ€æ±‚æ–‡æ¡£](./SETTLEMENT_ARBITRAGE_FULL_REQUIREMENT.md)
- [æœŸè´§ç­–ç•¥å‰ç«¯éœ€æ±‚](./FUTURES_FRONTEND_REQUIREMENTS.md)
- [æœŸè´§ç­–ç•¥å‰ç«¯TodoList](./FUTURES_FRONTEND_TODOLIST.md)

---

*æœ€åæ›´æ–°: 2026-02-09*
